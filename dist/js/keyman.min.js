function t(t){var e=this,n=this.getEl;return t||(t=document),this.downedKeyMap={},this.eventListMap={},this.keyMap={},this.downedKeyCount=0,this.shortcutInputObjs={},this.commanders={},n(t).addEventListener("keydown",function(t){var n=e.getKeyFromEvent(t);return null!=n&&(e.downedKeyMap[n]=!0),e.executeEvent("keydown",t),e.executeEvent("definedkeydown",n),e.executeEvent("pushshortcut",t),e.executeEvent("pushcommand",t),!0}),n(t).addEventListener("keyup",function(t){var n=e.getKeyFromEvent(t);return null!=n&&delete e.downedKeyMap[n],e.executeEvent("keyup",t),e.executeEvent("definedkeyup",n),e.executeEvent("pushshortcut",t),e.executeEvent("pushcommand",t),!0}),this}function e(e,n){this.superKeyMan=n,this.commanderName=e,this.downedDefinedKeyMap={},this.definedKeyMap={},this.definedKeydownFuncMap={},this.definedKeyupFuncMap={},this.definedKeyOrderList=[],this.standardDefinedKeyOrderList=[],this.isReversed=!1,this.lastDirection=null,this.lastBtn=null,this.timer=null,this.commandMap={},this.commandEventMap={},this.addCommand=function(t,e){return this.commandMap[t]=e,this},this.addCommandEvent=function(t,e){return this.commandEventMap[t]=e,this},this.addCommandMap=function(t){for(var e in t)this.commandMap[e]=t[e];return this},this.addCommandEventMap=function(t){for(var e in t)this.commandEventMap[e]=t[e];return this},this.defineKey=function(t,e,n,o){var i=this;if(n||(n=function(){}),o||(o=function(){}),this.definedKeydownFuncMap[t]=function(){i.downedDefinedKeyMap[t]=!0,n()},this.definedKeyupFuncMap[t]=function(){delete i.downedDefinedKeyMap[t],o()},e instanceof Array)for(var r=0;r<e.length;r++){var s=e[r];s=s.toUpperCase(),this.definedKeyMap[s]=t}else{var s=e;s=s.toUpperCase(),this.definedKeyMap[s]=t}},this.setUp=function(e,n,o){return this.defineKey(t.UP,e,n,o),this},this.setDown=function(e,n,o){return this.defineKey(t.DOWN,e,n,o),this},this.setLeft=function(e,n,o){return this.defineKey(t.LEFT,e,n,o),this},this.setRight=function(e,n,o){return this.defineKey(t.RIGHT,e,n,o),this},this.setButtonA=function(e,n,o){return this.defineKey(t.A,e,n,o),this},this.setButtonB=function(e,n,o){return this.defineKey(t.B,e,n,o),this},this.setButtonC=function(e,n,o){return this.defineKey(t.C,e,n,o),this},this.setButtonD=function(e,n,o){return this.defineKey(t.D,e,n,o),this},this.setReverse=function(t){return this.isReversed=t,this},this.handleDefinedKeydown=function(){var t=this;return function(e){var n=t.definedKeyMap[e],o=t.definedKeydownFuncMap[n];o&&o(),t.handleSaveKey(n)}},this.handleDefinedKeyup=function(){var t=this;return function(e){var n=t.definedKeyMap[e],o=t.definedKeyupFuncMap[n];o&&o(),t.handleSaveKey(n)}},this.getType=function(t){return"string"==typeof t?"btn":"direction"},this.handleSaveKey=function(t){var e,n,o,i,r=this,s=this.downedDefinedKeyMap;e=this.getDirectionCodeFromDownKeys(s,8),o=this.lastDirection==e,this.lastDirection=e,o||0==e||(this.definedKeyOrderList.push(e),this.isReversed&&(e=this.getReversedDirectionCodeList(e)),this.standardDefinedKeyOrderList.push(e)),n=this.getBtnCodeFromDownKeys(s),i=this.lastBtn==n,this.lastBtn=n,i||0==n||(this.definedKeyOrderList.push(n),this.standardDefinedKeyOrderList.push(n));var d=this.getMatchedCommand(this.standardDefinedKeyOrderList);!d||0==e&&0==n||(this.executeSkill(d),this.definedKeyOrderList=[],this.standardDefinedKeyOrderList=[]),0==e&&0==n||(clearTimeout(this.timer),this.timer=setTimeout(function(){r.definedKeyOrderList=[],r.standardDefinedKeyOrderList=[],r.lastDirection=null,r.lastBtn=null},300))},this.getMatchedCommand=function(t){var e={},n="",o=JSON.stringify(t);for(var i in this.commandMap){var r=JSON.stringify(this.commandMap[i]);r=r.substring(1,r.length-1),o.indexOf(r)!=-1&&(e[i]=r)}var s=Object.keys(e);if(1==s.length)n=s[0];else if(1<s.length){var d=0;for(var p in e)d<e[p].length&&(d=e[p].length,n=p)}return n},this.executeSkill=function(t){this.startSkill(t)},this.startSkill=function(t){var e=this.commandEventMap[t];e&&e()},this.serverReceiveSkill=function(t){},this.getDirectionCodeFromDownKeys=function(e,n){return 4==n||void 0===n?e[t.RIGHT]?t.RIGHT:e[t.LEFT]?t.LEFT:e[t.UP]?t.UP:e[t.DOWN]?t.DOWN:0:8==n?e[t.DOWN]&&e[t.RIGHT]?t.DOWNRIGHT:e[t.UP]&&e[t.RIGHT]?t.UPRIGHT:e[t.DOWN]&&e[t.LEFT]?t.DOWNLEFT:e[t.UP]&&e[t.LEFT]?t.UPLEFT:e[t.RIGHT]?t.RIGHT:e[t.LEFT]?t.LEFT:e[t.UP]?t.UP:e[t.DOWN]?t.DOWN:0:void 0},this.getReversedDirectionCodeList=function(t){return 4==t?6:6==t?4:7==t?9:9==t?7:1==t?3:3==t?1:t},this.getBtnCodeFromDownKeys=function(e){return e[t.A]?t.A:e[t.B]?t.B:e[t.C]?t.C:e[t.D]?t.D:0}}t.prototype.SHIFT="SHIFT",t.prototype.CTRL="CONTROL",t.prototype.ALT="ALT",t.prototype.ENTER="ENTER",t.prototype.ESC="ESCAPE",t.prototype.SPACE=" ",t.prototype.DELELTE="DELETE",t.prototype.BACKSPACE="BACKSPACE",t.prototype.INSERT="INSERT",t.prototype.HOME="HOME",t.prototype.END="END",t.prototype.PAGEDOWN="PAGEDOWN",t.prototype.PAGEDOWN="PAGEUP",t.prototype.DELELTE="BACKSPACE",t.prototype.HANGULMODE="HANGULMODE",t.prototype.HANJAMODE="HANJAMODE",t.prototype.N0="0",t.prototype.N1="1",t.prototype.N2="2",t.prototype.N3="3",t.prototype.N4="4",t.prototype.N5="5",t.prototype.N6="6",t.prototype.N7="7",t.prototype.N8="8",t.prototype.N9="9",t.prototype.F1="F1",t.prototype.F2="F2",t.prototype.F3="F3",t.prototype.F4="F4",t.prototype.F5="F5",t.prototype.F6="F6",t.prototype.F7="F7",t.prototype.F8="F8",t.prototype.F9="F9",t.prototype.F10="F10",t.prototype.F11="F11",t.prototype.F12="F12",t.prototype.keyCodeMap={8:"BACKSPACE",9:"TAB",13:"ENTER",16:"SHIFT",17:"CONTROL",18:"ALT",19:"PAUSE",20:"CAPSLOCK",27:"ESCAPE",32:" ",33:"PAGEUP",34:"PAGEDOWN",35:"END",36:"HOME",37:"ARROWLEFT",38:"ARROWUP",39:"ARROWRIGHT",40:"ARROWDOWN",45:"INSERT",46:"DELETE",144:"NUMBERLOCK",145:"SCROLLLOCK",186:";",187:"=",189:",",189:"-",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},t.prototype.rightKeyMap={CTRL:"CONTROL",ESC:"ESCAPE",DEL:"DELETE",SPACE:" ",UP:"ARROWUP",DOWN:"ARROWDOWN",RIGHT:"ARROWRIGHT",LEFT:"ARROWLEFT"},t.UP=8,t.DOWN=2,t.LEFT=4,t.RIGHT=6,t.DOWNRIGHT=3,t.DOWNLEFT=1,t.UPLEFT=7,t.UPRIGHT=9,t.A="A",t.B="B",t.C="C",t.D="D",t.prototype.convertToRightKeyFromKeys=function(t){for(var e,n,o=0;o<t.length;o++)n=t[o].toUpperCase(),e=this.rightKeyMap[n],t[o]=e?e:n;return t},t.prototype.getKeyFromEvent=function(t){var e,n=t.keyCode?t.keyCode:t.which,o=t.key?t.key:null;return 229==n?null:e=o?n&&48<=n&&n<=57?this.convertToKeyFromKeyCode(n):o.toUpperCase():this.convertToKeyFromKeyCode(n).toUpperCase()},t.prototype.convertToKeyFromKeyCode=function(t){var e="";return e+=this.keyCodeMap[t]?this.keyCodeMap[t]:65<=t&&t<=90?String.fromCharCode(t):96==t?0:97<=t&&t<=105?t-96:112<=t&&t<=123?"F"+(t-111):String.fromCharCode(t)},t.prototype.convertToKeyCodesFrom=function(t){for(var e=[],n=0;n<t.length;n++){var o=t[n];"string"==typeof o&&(o=o.charCodeAt(0)),e.push(o)}return e},t.prototype.isOnKey=function(t){return this.downedKeyMap[t.toUpperCase()]},t.prototype.checkKey=function(t){t=t.toUpperCase();var e=this.isOnKey(t);return delete this.downedKeyMap[t],e},t.prototype.clearKeyDownedMap=function(){for(var t in this.downedKeyMap)delete this.downedKeyMap[t]},t.prototype.addEventListener=function(t,e){this.eventListMap[t]||(this.eventListMap[t]=[]),this.eventListMap[t].push(e)},t.prototype.removeEventListener=function(t,e){var n=this.eventListMap[t];if(e){if(n&&n.length>0)for(var o=0;o<n.length;o++)e==n[o]&&n.splice(o,1)}else delete this.eventListMap[t]},t.prototype.executeEvent=function(t,e){var n=this.eventListMap[t];if(n)for(var o=0;o<n.length;o++)n[o](e)},t.prototype.isOn=function(t){var e=this.keyMap[t];return e&&e.isPressed},t.prototype.check=function(t){var e=this.isOn(t);if(e){var n=this.keyMap[t];n.keyup&&n.keyup(),n.isPressed=!1}return this.clearKeyDownedMap(),e},t.prototype.addShortcut=function(t){var e=this,n=t.name,o=this.convertToRightKeyFromKeys(t.keys),i=t.keydown,r=t.keypress,s=t.keyup,d=function(t){for(var s=0;s<o.length;s++)if(!e.isOnKey(o[s]))return e.keyMap[n].isPressed=!1,!1;var d=e.keyMap[n].data;return e.keyMap[n].isPressed||(e.keyMap[n].isPressed=!0,i&&i(d)),r&&r(d),!0},p=function(t){for(var i=0;i<o.length;i++)if(!e.isOnKey(o[i])){var r=e.keyMap[n].data;if(e.keyMap[n].isPressed)return e.keyMap[n].isPressed=!1,s&&s(r),!0}return!1};return n&&(this.keyMap[n]=t,this.keyMap[n].keydownImpl=d,this.keyMap[n].keyupImpl=p,this.keyMap[n].isPressed=!1),this.addEventListener("keydown",d),this.addEventListener("keyup",p),this},t.prototype.delShortcut=function(t){var e=this.keyMap[t];if(e){for(var n=["keydown","keyup"],o=0;o<n.length;o++){var i=n[o],r=n[o]+"Impl";e[r]&&this.removeEventListener(i,e[r])}delete this.keyMap[t]}return this},t.prototype.addCommand=function(t){this.addEventListener("saveCommand",plusFuncKeyDown)},t.prototype.delCommand=function(t){},t.prototype.lock=function(){},t.prototype.unlock=function(){},t.prototype.stop=function(){},t.prototype.start=function(){},t.prototype.detect=function(){var t=this;return getEl().ready(function(){tempEls=document.querySelectorAll("[data-shortcut-input]");for(var e=0;e<tempEls.length;e++)t.addShortcutInput(tempEls[e]);tempEls=document.querySelectorAll("[data-command-input]");for(var e=0;e<tempEls.length;e++)t.addShortcutInput(tempEls[e])}),this},t.prototype.addShortcutInput=function(t,e){e=e?e:{};var n=this,o=this.shortcutInputObjs,i=e.manid?e.manid:getEl(o).getNewSeqId("tmpKeyList");t.manid=i,this.shortcutInputObjs[i]=e,this.shortcutInputObjs[i].el=t,this.shortcutInputObjs[i].manid=i;var r=function(e){n.setShortcutInputValue(t,e," + ")};return getEl(t).addEventListener("focus",function(t){for(var e in n.downedKeyMap)delete n.downedKeyMap[e];n.startPushShortcutInputValue(r)}),getEl(t).addEventListener("blur",function(t){for(var e in n.downedKeyMap)delete n.downedKeyMap[e];n.stopPushShortcutInputValue(r)}),i},t.prototype.getShortcutInputById=function(t){var e=document.getElementById(t);return this.shortcutInputObjs[e.manid].keyList},t.prototype.getShortcutInputByManId=function(t){return this.shortcutInputObjs[t].keyList},t.prototype.setShortcutInputValue=function(t,e,n){n=n?n:" + ";var o=this.sortKeyList(e);t.value=null!=e?o.join(n):"";var i=t.manid;i&&(this.shortcutInputObjs[i].keyList=o)},t.prototype.sortKeyList=function(t){var e=["CONTROL","ALT","SHIFT"],n=t.sort(function(t,n){var o=e.indexOf(t),i=e.indexOf(n);return o!=-1&&o<i?0:i!=-1?1:-1});return n},t.prototype.startPushShortcutInputValue=function(t){var e=this,n=function(n){n.returnValue=!1;var o=Object.keys(e.downedKeyMap),i=e.downedKeyCount,r=o.length;return e.downedKeyCount=r,i<r&&t(o),!0};return this.addEventListener("pushshortcut",n),this},t.prototype.stopPushShortcutInputValue=function(){return this.removeEventListener("pushshortcut"),this},t.prototype.addCommandInput=function(t,e){e=e?e:{};var n=this,o=this.commandInputObjs,i=e.manid?e.manid:getEl(o).getNewSeqId("tmpKeyList");t.manid=i,this.commandInputObjs[i]=e,this.commandInputObjs[i].el=t,this.commandInputObjs[i].manid=i;var r=function(e){n.setCommandInputValue(t,e," + ")};return getEl(t).addEventListener("focus",function(t){for(var e in n.downedKeyMap)delete n.downedKeyMap[e];n.startPushCommandInputValue(r)}),getEl(t).addEventListener("blur",function(t){for(var e in n.downedKeyMap)delete n.downedKeyMap[e];n.stopPushCommandInputValue(r)}),i},t.prototype.getCommandInputById=function(t){var e=document.getElementById(t);return this.commandInputObjs[e.manid].keyList},t.prototype.getCommandInputByManId=function(t){return this.commandInputObjs[t].keyList},t.prototype.setCommandInputValue=function(t,e,n){n=n?n:" + ";var o=this.sortKeyList(e);t.value=null!=e?o.join(n):"";var i=t.manid;i&&(this.commandInputObjs[i].keyList=o)},t.prototype.startPushCommandInputValue=function(t){var e=this,n=function(n){n.returnValue=!1;var o=Object.keys(e.downedKeyMap),i=e.downedKeyCount,r=o.length;return e.downedKeyCount=r,i<r&&t(o),!0};return this.addEventListener("pushcommand",n),this},t.prototype.stopPushCommandInputValue=function(){return this.removeEventListener("pushcommand"),this},t.prototype.addCommander=function(t){var n;return this.commanders[t]||(n=new e(t,this),n.definedKeydownFunc=n.handleDefinedKeydown(),n.definedKeyupFunc=n.handleDefinedKeyup(),this.commanders[t]=n,this.addEventListener("definedkeydown",n.definedKeydownFunc),this.addEventListener("definedkeyup",n.definedKeyupFunc)),n},t.prototype.getCommander=function(t){return this.commanders[t]},t.prototype.delCommander=function(t){var e=this.commanders,n=e[t];return this.removeEventListener("definedkeydown",n.definedKeydownFunc),this.removeEventListener("definedkeyup",n.definedKeyupFunc),delete e[t],this},t.prototype.getEl=function(t){var e="object"==typeof t?t:document.getElementById(t),n={addEventListener:function(t,n){return navigator.userAgent.indexOf("Firefox")!=-1&&e.addEventListener(t,function(t){window.event=t},!0),e.addEventListener?e.addEventListener(t,function(t){n(t)}):e.attachEvent("on"+t,function(t){!t.target&&t.srcElement&&(t.target=t.srcElement),n(t)}),!0}};return n};